var j=jQuery.noConflict();(function(a){j(document).on("ready",function(){tinymce.init({selector:"textarea.edit-wysiwg",theme:"modern",height:600,document_base_url:_root_,remove_script_host:false,relative_urls:false,convert_urls:false,plugins:["advlist autolink link image code lists charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars insertdatetime media nonbreaking","table contextmenu directionality emoticons paste textcolor responsivefilemanager"],toolbar1:"undo redo | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | styleselect",toolbar2:"| responsivefilemanager | link unlink anchor | image media | forecolor backcolor  | print preview code ",image_advtab:true,external_filemanager_path:_root_+"filemanager/",filemanager_title:"Responsive Filemanager",external_plugins:{filemanager:_root_+"filemanager/plugin.min.js"}});
j("#datetimepicker-add").datetimepicker({defaultDate:moment()});j("#datetimepicker-edit").datetimepicker({defaultDate:moment(j("#datetimepicker-edit").data("datetime"))});
j(".content").load(_root_+"admin/newsletters/displayAjax");j(document).on("click",".pagination-digg li a",function(c){c.preventDefault();spinner.spin(target);
var b=j(this).attr("href");j(".content").load(b);spinner.stop();});j(document).on("click",".link-ajax",function(c){c.preventDefault();var b=j(this).attr("href");
j(".content").load(b);});j(document).on("click","#goto-btn",function(f){f.preventDefault();spinner.spin(target);var e=parseInt(j(".goto").val());var b=parseInt(j(this).data("maxpage"));
if(e>0&&e<=b){var d=j(this).data("href");var c=(e-1)*parseInt(j(this).data("limit"));j(".content").load(d+c);spinner.stop();}else{spinner.stop();return false;
}});j(document).on("click","#search-btn",function(d){d.preventDefault();var b=j(this).data("href");var c=j(this).parent().prev().val();j(".content").load(b+c);
});j("[name='status']").bootstrapSwitch({size:"small",onColor:"success",radioAllOff:true});j("body").on("click",'input[id^="temp-"]',function(){var c=j(this).val();
var b=j(this).data("news");spinner.spin(target);if(b>"0"){j.post(_root_+"admin/newsletters/getNewsletter",{id:c},function(d){if(d){j.get(d[0].guid,function(e){tinyMCE.activeEditor.setContent(e);
spinner.stop();});}},"json");}else{j.post(_root_+"admin/newsletters/selectTemplate",{id:c},function(d){if(d){j.get(d[0].guid,function(e){tinyMCE.activeEditor.setContent(e);
spinner.stop();});}},"json");}});j("body").on("click",".delete",function(b){b.preventDefault();var c=j(this);spinner.spin(target);jConfirm("¿Desea eliminar este registro?","¡Eliminación!",function(d){if(d){var e=c.data("id");
j.post(_root_+"admin/newsletters/delete",{id:e},function(f){spinner.stop();if(f){j(".content").load(_root_+"admin/newsletters/displayAjax");}});}else{spinner.stop();
}});});j("body").on("click",".ico-status",function(c){c.preventDefault();var b=j(this).data("status");b=(b=="1")?0:1;var d=j(this).data("id");spinner.spin(target);
j.post(_root_+"admin/newsletters/action",{id:d,status:b},function(e){if(e){j(".content").load(_root_+"admin/newsletters/displayAjax");spinner.stop();}});
});j("#send-test").on("click",function(d){d.preventDefault();var c=j("#test-email").val();var b=j("#test-name").val();var e=j(this).data("id");if(!validEmail(c)){return;
}if(b.length==0){return;}spinner.spin(target);j.post(_root_+"admin/newsletters/sendEmail",{email:c,name:b,id:e},function(f){if(f){j("#test-email").val("");
j("#test-name").val("");jAlert("Se envio correctamente el mensaje","Aviso");}spinner.stop();});});loadContent();});})(jQuery);function loadContent(){$url=document.URL;
if($url.substr(0,$url.length-1)==_root_+"admin/newsletters/edit/"){$id=$url.slice(-1);j.post(_root_+"admin/newsletters/getNewsletter",{id:$id},function(a){if(a){j.get(a[0].guid,function(b){tinyMCE.activeEditor.setContent(b);
});}},"json");}}