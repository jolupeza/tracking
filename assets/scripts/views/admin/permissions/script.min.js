var j=jQuery.noConflict();(function(a){j(document).on("ready",function(){j("[name='status']").bootstrapSwitch({size:"small",onColor:"success",radioAllOff:true});
j(document).on("click","#goto-btn",function(f){f.preventDefault();var e=parseInt(j(".goto").val());var b=parseInt(j(this).data("maxpage"));if(e>0&&e<=b){var d=j(this).data("href");
var c=(e-1)*parseInt(j(this).data("limit"));c=(parseInt(c)==0)?"":c;window.location=d+c;}else{jAlert("Ingrese una p&aacute;gina entre 1 y "+b,"Advertencia");
j(".goto").val("");return false;}});j(document).on("click","#search-btn",function(d){d.preventDefault();var b=j(this).data("href");var c=j(this).parent().prev().val();
window.location=b+c;});j("body").on("click",".ico-status",function(c){c.preventDefault();spinner.spin(target);var d=j(this);var b=j(this).data("status");
b=(b=="1")?0:1;var e=j(this).data("id");j.post(_root_+"admin/permissions/action",{id:e,status:b},function(f){if(f){d.html("");d.data("status",b);content="";
if(b){content='<i class="fa fa-check"></i>';}else{content='<i class="fa fa-times"></i>';}d.html(content);}});spinner.stop();});j("body").on("click",".ico-del",function(b){b.preventDefault();
var c=j(this).data("id");jConfirm("¿Desea eliminar este registro?","¡Eliminación!",function(d){if(d){j.post(_root_+"admin/permissions/delete",{id:c},function(e){if(e){window.location=_root_+"admin/permissions";
}});}});});j("body").on("click",".del-perm",function(b){b.preventDefault();var c=j(this).data("id");jConfirm("¿Desea eliminar este registro?","¡Eliminación!",function(d){if(d){j.post(_root_+"admin/permissions/delPerm",{id:c},function(e){if(e){window.location=_root_+"admin/permissions/perms";
}else{jAlert("No se pudo eliminar el registro seleccionado. Por favor vuelva a intentarlo.","Aviso");}});}});});j("#add-perm").on("click",function(c){c.preventDefault();
spinner.spin(target);var d=j("#title").val();var b=j("#name").val();if(d.length==0){j("#title").focus();spinner.stop();return;}if(b.length==0){j("#name").focus();
spinner.stop();return;}j.post(_root_+"admin/permissions/verifyKey",{name:b},function(e){if(e){j("#name").val("Clave ya existe. Por favor ingresa otra.");
}else{j.post(_root_+"admin/permissions/addPerm",{title:d,name:b},function(f){j("#modalAddPerm").modal("hide");if(f){window.location=_root_+"admin/permissions/perms";
}else{jAlert("No se pudo agregar el nuevo permiso. Por favor verifique y vuelva a intentar.","Aviso");}});}});spinner.stop();});j("#modalAddPerm").on("hidden.bs.modal",function(b){j("#title").val("");
j("#name").val("");});j("#modalAddPerm").on("shown.bs.modal",function(b){j("#title").focus();});j("#edit-perm").on("click",function(c){c.preventDefault();
var d=j("#titleEdit").val();var b=j("#nameEdit").val();var e=j("#perm_id").val();if(d.length==0){j("#titleEdit").focus();return;}if(b.length==0){spinner.stop();
return;}j.post(_root_+"admin/permissions/getPerm",{id:e},function(f){if(f){if(f.name!=b){j.post(_root_+"admin/permissions/verifyKey",{name:b},function(g){console.log(g);
if(g){j("#nameEdit").val(f.name).focus();}else{j.post(_root_+"admin/permissions/editPerm",{id:e,title:d,name:b},function(h){j("#modalEditPerm").modal("hide");
if(h){tr=j("#perm-"+e);tr.find("td").eq(1).html(h.title);tr.find("td").eq(2).html(h.name);}else{jAlert("No se pudo modificar los datos del permiso. Por favor verifique y vuelva a intentar.","Aviso");
}},"json");}});}else{j.post(_root_+"admin/permissions/editPerm",{id:e,title:d,name:b},function(g){j("#modalEditPerm").modal("hide");if(g){tr=j("#perm-"+e);
tr.find("td").eq(1).html(g.title);tr.find("td").eq(2).html(g.name);}else{jAlert("No se pudo modificar los datos del permiso. Por favor verifique y vuelva a intentar.","Aviso");
}},"json");}}},"json");});j("#modalEditPerm").on("hidden.bs.modal",function(b){j("#titleEdit").val("");j("#nameEdit").val("");});j("#modalEditPerm").on("shown.bs.modal",function(c){var b=c.relatedTarget;
id=b.attributes[2];id=id.value;j.post(_root_+"admin/permissions/getPerm",{id:id},function(d){if(d){j("#titleEdit").val(d.title);j("#nameEdit").val(d.name);
j("#perm_id").val(id);}},"json");j("#titleEdit").focus();});});})(jQuery);